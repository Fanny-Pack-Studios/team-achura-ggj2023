[gd_scene load_steps=44 format=3 uid="uid://be8v1c686rjqf"]

[ext_resource type="Script" path="res://src/characters/Enemies/RangedEnemy.gd" id="1_nwbmc"]
[ext_resource type="PackedScene" uid="uid://bow024vtgyl7c" path="res://src/characters/Enemies/EnemyBullet.tscn" id="2_igqmj"]
[ext_resource type="Script" path="res://src/characters/behaviours/AccelerationBehaviour.gd" id="3_orm7m"]
[ext_resource type="Script" path="res://src/characters/behaviours/AttackingBehaviour.gd" id="4_qttoi"]
[ext_resource type="Script" path="res://src/characters/behaviours/ShootingProjectileBehaviour.gd" id="5_i42qq"]
[ext_resource type="Script" path="res://src/characters/behaviours/HealthBehaviour.gd" id="7_goap5"]
[ext_resource type="Script" path="res://src/characters/hithurtboxes/HurtBox.gd" id="8_scyix"]
[ext_resource type="Script" path="res://src/characters/behaviours/AnimationStateMachineBehaviour.gd" id="11_c7hah"]
[ext_resource type="PackedScene" uid="uid://bolc1i5nyc26f" path="res://assets/gltf/FlyingAnt.gltf" id="12_jxhl3"]
[ext_resource type="PackedScene" uid="uid://c2lu4g4enrlv7" path="res://src/camera/EnemyHPBar.tscn" id="12_o5moy"]
[ext_resource type="Script" path="res://src/characters/sid/Sound/Steps.gd" id="12_oa1e8"]
[ext_resource type="AudioStream" uid="uid://cy2gffbhnauvk" path="res://assets/audio/enemies/pain/Pain1.wav" id="13_i27vf"]
[ext_resource type="Material" uid="uid://co7rtkg6tjvqu" path="res://assets/materials/enemy_hurt_material.tres" id="13_yt1ap"]
[ext_resource type="AudioStream" uid="uid://b0kji0gy6pa2h" path="res://assets/audio/enemies/pain/Pain2.wav" id="14_px3qh"]
[ext_resource type="AudioStream" uid="uid://djd5lah8m68wb" path="res://assets/audio/enemies/pain/Pain3.wav" id="15_33mwq"]
[ext_resource type="AudioStream" uid="uid://coqnolvvx3vfl" path="res://assets/audio/enemies/pain/Pain4.wav" id="16_pbpli"]
[ext_resource type="AudioStream" uid="uid://r6fxwmwr2tcs" path="res://assets/audio/enemies/pain/Pain5.wav" id="17_c1b6o"]
[ext_resource type="AudioStream" uid="uid://dvnh8uy72i46h" path="res://assets/audio/enemies/pain/Pain6.wav" id="18_nptns"]
[ext_resource type="AudioStream" uid="uid://dhfbg8hbgde0n" path="res://assets/audio/enemies/death/Death1.wav" id="19_2n7pg"]
[ext_resource type="AudioStream" uid="uid://cky7axpfqxkp3" path="res://assets/audio/enemies/death/Death2.wav" id="20_a2gku"]
[ext_resource type="AudioStream" uid="uid://ct0xf52ijimlg" path="res://assets/audio/enemies/EnemyFly.wav" id="21_exxww"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_hn8fk"]
radius = 0.4
height = 1.5

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_2k7hu"]
height = 1.6

[sub_resource type="SphereShape3D" id="SphereShape3D_16e8e"]
radius = 11.9566

[sub_resource type="Animation" id="Animation_t6465"]
resource_name = "Die"
length = 1.5
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("FlyingAnt/FlyingAnt_Bones/Skeleton3D/FlyingAnt2:transparency")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.8, 1.5),
"transitions": PackedFloat32Array(1, 1, 1),
"update": 0,
"values": [0.0, 0.0, 1.0]
}

[sub_resource type="Animation" id="Animation_clb4f"]
resource_name = "Hurt"
length = 0.5
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("FlyingAnt/FlyingAnt_Bones/Skeleton3D/FlyingAnt2:instance_shader_parameters/alpha")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.5),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [1.0, 0.0]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("FlyingAnt/FlyingAnt_Bones/Skeleton3D/FlyingAnt2:instance_shader_parameters/grow")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0, 0.5),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [0.1, 0.01]
}

[sub_resource type="Animation" id="Animation_l0qyq"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("FlyingAnt/FlyingAnt_Bones/Skeleton3D/FlyingAnt2:instance_shader_parameters/alpha")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [0.0]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("FlyingAnt/FlyingAnt_Bones/Skeleton3D/FlyingAnt2:instance_shader_parameters/grow")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [0.01]
}
tracks/2/type = "value"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("FlyingAnt/FlyingAnt_Bones/Skeleton3D/FlyingAnt2:transparency")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [0.0]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_tqjfq"]
_data = {
"Die": SubResource("Animation_t6465"),
"Hurt": SubResource("Animation_clb4f"),
"RESET": SubResource("Animation_l0qyq")
}

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_k8srx"]
animation = &"Die"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_686d1"]
animation = &"Idle"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_arn82"]
animation = &"Move"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_lypkx"]
animation = &"Shoot"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_2pshm"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_l5jr2"]

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_3hr42"]
xfade_time = 0.1

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_pvmu2"]
xfade_time = 0.1

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_b5nan"]
switch_mode = 2
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_iyb0f"]
xfade_time = 0.1

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_omhpy"]
xfade_time = 0.1

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_0o3ho"]

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_ls8tb"]
states/Die/node = SubResource("AnimationNodeAnimation_k8srx")
states/Die/position = Vector2(670, 145)
states/Idle/node = SubResource("AnimationNodeAnimation_686d1")
states/Idle/position = Vector2(368, 94)
states/Move/node = SubResource("AnimationNodeAnimation_arn82")
states/Move/position = Vector2(427, 257)
states/Shoot/node = SubResource("AnimationNodeAnimation_lypkx")
states/Shoot/position = Vector2(535, 32)
transitions = ["Start", "Idle", SubResource("AnimationNodeStateMachineTransition_2pshm"), "Idle", "Shoot", SubResource("AnimationNodeStateMachineTransition_l5jr2"), "Idle", "Move", SubResource("AnimationNodeStateMachineTransition_3hr42"), "Move", "Idle", SubResource("AnimationNodeStateMachineTransition_pvmu2"), "Shoot", "Idle", SubResource("AnimationNodeStateMachineTransition_b5nan"), "Shoot", "Die", SubResource("AnimationNodeStateMachineTransition_iyb0f"), "Move", "Die", SubResource("AnimationNodeStateMachineTransition_omhpy"), "Idle", "Die", SubResource("AnimationNodeStateMachineTransition_0o3ho")]
graph_offset = Vector2(-40, -90)

[sub_resource type="AnimationNodeStateMachinePlayback" id="AnimationNodeStateMachinePlayback_1yr7y"]

[sub_resource type="BoxShape3D" id="BoxShape3D_3tm33"]
size = Vector3(0.1, 0.1, 0.1)

[node name="RangedEnemy" type="CharacterBody3D"]
collision_layer = 8
collision_mask = 7
script = ExtResource("1_nwbmc")
bullet_scene = ExtResource("2_igqmj")
mass = 2.0

[node name="AccelerationBehaviour" type="Node" parent="."]
script = ExtResource("3_orm7m")
acceleration_magnitude = 15.0
turn_speed = 2.0
accelerate_forward = true

[node name="AttackingBehaviour" type="Node" parent="."]
script = ExtResource("4_qttoi")
attack_wait_time = 1.5

[node name="ShootingProjectileBehaviour" type="Node" parent="." node_paths=PackedStringArray("spawn_point")]
script = ExtResource("5_i42qq")
ProjectileScene = ExtResource("2_igqmj")
spawn_point = NodePath("../BulletSpawnPoint")

[node name="HealthBehaviour" type="Node" parent="."]
script = ExtResource("7_goap5")
max_health = 30

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, -1, 0, 1, -4.37114e-08, 0, 1.00612, 0.103913)
shape = SubResource("CapsuleShape3D_hn8fk")

[node name="HurtArea" type="Area3D" parent="."]
collision_layer = 8
collision_mask = 0
script = ExtResource("8_scyix")

[node name="HurtAreaCollision" type="CollisionShape3D" parent="HurtArea"]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, 1, 0, -1, -4.37114e-08, 0, 0.894088, 0.119677)
shape = SubResource("CapsuleShape3D_2k7hu")

[node name="BulletSpawnPoint" type="Node3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.33322, -0.585797)

[node name="EnemyHPBar" parent="." instance=ExtResource("12_o5moy")]

[node name="IdleTarget" type="Node3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.127391, 0, -2.22611)

[node name="AlertRange" type="Area3D" parent="."]
collision_layer = 0
collision_mask = 8

[node name="CollisionShape3D" type="CollisionShape3D" parent="AlertRange"]
shape = SubResource("SphereShape3D_16e8e")

[node name="FlyingAnt" parent="." instance=ExtResource("12_jxhl3")]
transform = Transform3D(-0.4, 0, -6.03983e-08, 0, 0.4, 0, 6.03983e-08, 0, -0.4, 0, 0, 0)

[node name="Skeleton3D" parent="FlyingAnt/FlyingAnt_Bones" index="0"]
bones/1/position = Vector3(-0.401096, 0.207582, 1.46681)
bones/1/rotation = Quaternion(0.673125, 0.673125, 0.216569, -0.216569)
bones/2/rotation = Quaternion(0.571749, -0.289073, -0.528343, 0.55713)
bones/3/position = Vector3(-0.295732, 0.476923, 0.446177)
bones/3/rotation = Quaternion(0.705863, 0.705863, -0.0419184, 0.0419184)
bones/5/position = Vector3(0.0264368, 0.98365, 1.64975)
bones/5/rotation = Quaternion(0.689464, 0.69564, 0.15697, -0.126826)
bones/6/rotation = Quaternion(0.791507, 0.0739132, 0.233341, 0.560006)
bones/7/position = Vector3(1.35719e-13, -2.2889e-08, 3.03401)
bones/7/rotation = Quaternion(2.659e-07, 0.989255, 0.146199, -6.1666e-07)
bones/8/position = Vector3(-4.03143e-08, -0.4956, -0.0039456)
bones/8/rotation = Quaternion(0.962528, 0.0952286, 0.159142, 0.197853)
bones/9/position = Vector3(-3.78456e-07, 1.08509, 0.28021)
bones/9/rotation = Quaternion(0.545322, -1.1297e-07, 2.08321e-07, 0.838227)
bones/11/position = Vector3(0.127877, 0.0105491, -0.294376)
bones/11/rotation = Quaternion(0.248843, 0.575815, -0.778661, -0.014188)
bones/12/rotation = Quaternion(0.000935718, -0.165284, -0.0405146, 0.985413)
bones/13/rotation = Quaternion(-0.390501, 0.135824, 0.0991891, 0.905109)
bones/14/rotation = Quaternion(-0.178462, 0.0382752, -0.054897, 0.981668)
bones/15/rotation = Quaternion(-0.160474, 0.0642466, 0.00177431, 0.984945)
bones/16/rotation = Quaternion(-0.0405366, -0.0891574, 0.130414, 0.98661)
bones/17/position = Vector3(-0.127877, 0.0105492, -0.294376)
bones/17/rotation = Quaternion(-0.248842, 0.575815, -0.778661, 0.0141885)
bones/18/rotation = Quaternion(0.000935713, 0.165284, 0.0405146, 0.985413)
bones/19/rotation = Quaternion(-0.390501, -0.135824, -0.0991891, 0.905109)
bones/20/rotation = Quaternion(-0.178462, -0.0382753, 0.0548969, 0.981668)
bones/21/rotation = Quaternion(-0.160474, -0.0642466, -0.00177431, 0.984945)
bones/22/rotation = Quaternion(0.290639, 0.613366, 0.510308, 0.528107)
bones/23/rotation = Quaternion(0.458904, -0.100697, 0.120283, 0.874528)
bones/24/rotation = Quaternion(0.851438, -0.0974413, -0.0839855, -0.508435)
bones/25/rotation = Quaternion(-0.085487, -0.0295755, -0.00363742, 0.995894)
bones/26/rotation = Quaternion(0.511508, 0.296971, 0.381628, 0.710301)
bones/27/rotation = Quaternion(0.453326, -0.057107, 0.0984034, 0.884054)
bones/28/rotation = Quaternion(0.482493, -0.139807, -0.00638225, -0.864646)
bones/29/rotation = Quaternion(0.0262521, 0.0666003, 0.0520345, 0.996076)
bones/30/rotation = Quaternion(0.744485, 0.343514, 0.128207, 0.557946)
bones/31/rotation = Quaternion(0.575925, -0.0541111, 0.132676, 0.804847)
bones/32/rotation = Quaternion(0.881919, -0.0708916, -0.0915176, -0.456967)
bones/33/rotation = Quaternion(-0.3083, -0.0322849, 0.0304882, 0.950252)
bones/34/rotation = Quaternion(-0.315529, 0.599094, 0.507852, -0.532554)
bones/35/rotation = Quaternion(0.442433, 0.106301, -0.127777, 0.881264)
bones/36/rotation = Quaternion(0.802998, 0.124729, 0.0783364, -0.577495)
bones/37/rotation = Quaternion(-0.0647607, 0.0283193, -0.00145686, 0.997498)
bones/38/rotation = Quaternion(0.511509, -0.296973, -0.381627, 0.7103)
bones/39/rotation = Quaternion(0.453326, 0.0571068, -0.0984036, 0.884054)
bones/40/rotation = Quaternion(0.482494, 0.139807, 0.00638237, -0.864646)
bones/41/rotation = Quaternion(0.0262513, -0.0666003, -0.0520345, 0.996076)
bones/42/rotation = Quaternion(0.744485, -0.343514, -0.128206, 0.557946)
bones/43/rotation = Quaternion(0.575925, 0.0541112, -0.132676, 0.804847)
bones/44/rotation = Quaternion(0.881919, 0.0708916, 0.0915177, -0.456966)
bones/45/rotation = Quaternion(-0.3083, 0.0322848, -0.0304882, 0.950252)
bones/46/position = Vector3(0.383188, 0.28824, -0.375793)
bones/46/rotation = Quaternion(0.805348, 0.40829, -0.0203711, -0.429301)
bones/47/position = Vector3(-0.383187, 0.28824, -0.375794)
bones/47/rotation = Quaternion(0.805348, -0.408289, 0.0203721, -0.429302)
bones/48/rotation = Quaternion(0.780019, 0.43297, 0.220357, -0.394399)
bones/49/rotation = Quaternion(0.780019, -0.432969, -0.220356, -0.3944)
bones/50/position = Vector3(0.401096, 0.207582, 1.46681)
bones/50/rotation = Quaternion(-0.673125, 0.673125, 0.216569, 0.216569)
bones/51/rotation = Quaternion(0.571749, 0.289073, 0.528343, 0.55713)
bones/52/position = Vector3(0.295732, 0.476923, 0.446177)
bones/52/rotation = Quaternion(0.705863, -0.705863, 0.0419184, 0.0419184)
bones/54/position = Vector3(0.0167421, 0.98365, 1.47632)
bones/54/rotation = Quaternion(0.648293, -0.707092, -0.282341, 0.0046335)
bones/55/rotation = Quaternion(0.791507, -0.0739132, -0.233341, 0.560006)

[node name="FlyingAnt2" parent="FlyingAnt/FlyingAnt_Bones/Skeleton3D" index="0"]
material_overlay = ExtResource("13_yt1ap")
instance_shader_parameters/alpha = 0.0
instance_shader_parameters/grow = 0.01

[node name="EffectsAnimationPlayer" type="AnimationPlayer" parent="."]
libraries = {
"": SubResource("AnimationLibrary_tqjfq")
}

[node name="AnimationTree" type="AnimationTree" parent="."]
tree_root = SubResource("AnimationNodeStateMachine_ls8tb")
anim_player = NodePath("../FlyingAnt/AnimationPlayer")
active = true
parameters/playback = SubResource("AnimationNodeStateMachinePlayback_1yr7y")

[node name="StateMachine" type="Node" parent="." node_paths=PackedStringArray("animation_tree")]
script = ExtResource("11_c7hah")
animation_tree = NodePath("../AnimationTree")

[node name="CollisionShape3D2" type="CollisionShape3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.05, 0)
shape = SubResource("BoxShape3D_3tm33")

[node name="PainSounds" type="Node3D" parent="."]
script = ExtResource("12_oa1e8")

[node name="Pain1" type="AudioStreamPlayer3D" parent="PainSounds"]
stream = ExtResource("13_i27vf")

[node name="Pain2" type="AudioStreamPlayer3D" parent="PainSounds"]
stream = ExtResource("14_px3qh")

[node name="Pain3" type="AudioStreamPlayer3D" parent="PainSounds"]
stream = ExtResource("15_33mwq")

[node name="Pain4" type="AudioStreamPlayer3D" parent="PainSounds"]
stream = ExtResource("16_pbpli")

[node name="Pain5" type="AudioStreamPlayer3D" parent="PainSounds"]
stream = ExtResource("17_c1b6o")

[node name="Pain6" type="AudioStreamPlayer3D" parent="PainSounds"]
stream = ExtResource("18_nptns")

[node name="DeathSounds" type="Node3D" parent="."]
script = ExtResource("12_oa1e8")

[node name="Death1" type="AudioStreamPlayer3D" parent="DeathSounds"]
stream = ExtResource("19_2n7pg")

[node name="Death2" type="AudioStreamPlayer3D" parent="DeathSounds"]
stream = ExtResource("20_a2gku")

[node name="FlySound" type="AudioStreamPlayer3D" parent="."]
stream = ExtResource("21_exxww")
attenuation_model = 1
autoplay = true
stream_paused = true
max_distance = 100.0

[connection signal="attack" from="AttackingBehaviour" to="." method="_on_attacking_behaviour_attack"]
[connection signal="current_changed" from="HealthBehaviour" to="EnemyHPBar/HPBar" method="set_current_hp"]
[connection signal="damaged" from="HealthBehaviour" to="EnemyHPBar/HPBar" method="damaged"]
[connection signal="healed" from="HealthBehaviour" to="EnemyHPBar/HPBar" method="healed"]
[connection signal="max_changed" from="HealthBehaviour" to="EnemyHPBar/HPBar" method="set_max_hp"]
[connection signal="no_health" from="HealthBehaviour" to="." method="_on_health_behaviour_no_health"]
[connection signal="damaged" from="HurtArea" to="." method="_on_hurt_area_damaged"]

[editable path="EnemyHPBar"]
[editable path="FlyingAnt"]
